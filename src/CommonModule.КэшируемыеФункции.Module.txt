// ADO функции

Функция ОпределитьТекстУсловияОтбораПостроке(стрВидСравнения) Экспорт
   
    врстрВидСравнения = ВРЕГ(стрВидСравнения);
   
    Если врстрВидСравнения = "РАВНО" Тогда
       
        Возврат "=";
       
    ИначеЕсли врстрВидСравнения = "НЕРАВНО" Тогда
       
        Возврат "<>";
       
    ИначеЕсли врстрВидСравнения = "БОЛЬШЕ" Тогда
       
        Возврат ">";
       
    ИначеЕсли врстрВидСравнения = "МЕНЬШЕ" Тогда
       
        Возврат "<";
       
    Иначе
       
        Возврат "=";
       
    КонецЕсли;
   
КонецФункции

Функция ПолучитьСтрокуПодключенияADOПоУмолчанию()
   
	Возврат "";
   
КонецФункции

Функция ИницилизироватьADO(СтрокаПодключения = "", стрОшибки = "") Экспорт
   
    Если СтрокаПодключения = "" Тогда
        СтрокаПодключения = ПолучитьСтрокуПодключенияADOПоУмолчанию();
    КонецЕсли;
   
    Соединение     = Новый COMОбъект("ADODB.Connection");

    Попытка
        Соединение.Open(СтрокаПодключения);
    Исключение
        опОш = ОписаниеОшибки();
        глПротокол = Неопределено;
        стрОшибки = "Ошибка создания ADO соединения
                |" + опОш;
		Возврат Неопределено;
	КонецПопытки;
   
	Возврат Соединение;
КонецФункции
