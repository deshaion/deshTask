Процедура ОповеститьПоПочте(Кому, Тема, ТексПисьма, Отказ)
	
	Если Не ПустаяСтрока(Кому) Тогда
		
	//Кому = ?(ЭтоНовый(), Исполнитель.Почта, СформироватьАдресаПолучатели());
	
		Если Кому <> "" Тогда
			
			// Заполним
			
			Письмо = Документы.Письмо.СоздатьДокумент();
			Письмо.Дата 			= ТекущаяДата();
			Письмо.Тема 			= Тема;
			Письмо.Кому 			= Кому;
			Письмо.Текст 			= ТексПисьма;
			Письмо.УчетнаяЗапись 	= Справочники.УчетныеЗаписиЭлектроннойПочты.СистемнаяУчетнаяЗаписьЭлектроннойПочты;
			
			// Запишем
			
			Попытка
				Письмо.Записать(РежимЗаписиДокумента.Проведение);
			Исключение
				ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОбщегоНазначенияКлиентСервер.ПолучитьПредставлениеОписанияОшибки(ИнформацияОбОшибке()));
				Отказ = Истина;
				Возврат;
			КонецПопытки;
			
			// Поставим в очередь
			
			Рег = РегистрыСведений.БуферПочтыДляОтправки.СоздатьМенеджерЗаписи();
			Рег.Письмо = Письмо.Ссылка;
			
			Попытка
				Рег.Записать();
			Исключение
				ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОбщегоНазначенияКлиентСервер.ПолучитьПредставлениеОписанияОшибки(ИнформацияОбОшибке()));
				Отказ = Истина;
				Возврат;
			КонецПопытки;
			
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

Процедура ОтправитьПисьмо(Кому, Тема, ТексПисьма, стрОшибки = "") Экспорт 
	
	новоеПисьмо = Документы.Письмо.СоздатьДокумент();
	новоеПисьмо.Дата = ТекущаяДата();
	новоеПисьмо.Кому = Кому;
	новоеПисьмо.УчетнаяЗапись = Справочники.УчетныеЗаписиЭлектроннойПочты.СистемнаяУчетнаяЗаписьЭлектроннойПочты;
	новоеПисьмо.Тема = Тема;
	новоеПисьмо.Текст = ТексПисьма;
	
	новоеПисьмо.Записать();
	новоеПисьмо = новоеПисьмо.Ссылка;
	стрОшибки = "";
	
	Если Документы.Письмо.ПослатьПисьмо(новоеПисьмо, стрОшибки) Тогда
		ЗаписьЖурналаРегистрации(
			"Письма.Отправление письма", 
			УровеньЖурналаРегистрации.Информация,
			Метаданные.Документы.Письмо,
			новоеПисьмо,
			"Письмо успешно отправлено");
	Иначе
		ЗаписьЖурналаРегистрации(
			"Письма.Отправление письма", 
			УровеньЖурналаРегистрации.Ошибка,
			Метаданные.Документы.Письмо,
			новоеПисьмо,
			"Письмо отправить не удалось:
				|" + стрОшибки);
	КонецЕсли;
	
КонецПроцедуры
